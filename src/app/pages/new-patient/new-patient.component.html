<div class="header">
    <button mat-icon-button [routerLink]="['/dashboard/patients']">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2>New Patient</h2>
  </div>
  
  <mat-card *ngIf="success" class="success-alert">
    <mat-icon>check_circle</mat-icon>
    Patient created successfully!
  </mat-card>
  
  <mat-card *ngIf="error" class="error-alert">
    <mat-icon>error</mat-icon>
    {{ error }}
  </mat-card>

  <div class="form-wrapper">
  <form [formGroup]="form" (ngSubmit)="submitForm()">
    <mat-card >
      <h3>Personal Information</h3>
      <mat-divider></mat-divider>
  
      <div class="grid">
        <mat-form-field appearance="fill">
          <mat-label >First Name</mat-label>
          <input matInput formControlName="firstName" />
          <mat-error *ngIf="f['firstName'].invalid">First name is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Last Name</mat-label>
          <input matInput formControlName="lastName" />
          <mat-error *ngIf="f['lastName'].invalid">Last name is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Date of Birth</mat-label>
          <input matInput type="date" formControlName="dateOfBirth" />
          <mat-error *ngIf="f['dateOfBirth'].invalid">Date of birth is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Gender</mat-label>
          <mat-select formControlName="gender">
            <mat-option value="Male">Male</mat-option>
            <mat-option value="Female">Female</mat-option>
            <mat-option value="Other">Other</mat-option>
          </mat-select>
          <mat-error *ngIf="f['gender'].invalid">Gender is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" />
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Contact Number</mat-label>
          <input matInput formControlName="contactNumber" />
          <mat-error *ngIf="f['contactNumber'].invalid">Contact number is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Address</mat-label>
          <textarea matInput formControlName="address" rows="2"></textarea>
          <mat-error *ngIf="f['address'].invalid">Address is required</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Blood Type</mat-label>
          <mat-select formControlName="bloodType">
            <mat-option *ngFor="let type of bloodTypes" [value]="type">{{ type }}</mat-option>
          </mat-select>
        </mat-form-field>
  
        <mat-form-field appearance="fill">
          <mat-label>Allergies (comma separated)</mat-label>
          <input matInput formControlName="allergies" />
        </mat-form-field>
      </div>
    </mat-card>
    <mat-card>
        <h3>Emergency Contact</h3>
        <mat-divider></mat-divider>
      
        <div class="grid">
          <mat-form-field appearance="fill">
            <mat-label>Name</mat-label>
            <input matInput formControlName="emergencyContactname" />
          </mat-form-field>
      
          <mat-form-field appearance="fill">
            <mat-label>Relationship</mat-label>
            <input matInput formControlName="emergencyContactrelationship" />
          </mat-form-field>
      
          <mat-form-field appearance="fill">
            <mat-label>Phone</mat-label>
            <input matInput formControlName="emergencyContactphone" />
          </mat-form-field>
        </div>
      </mat-card>
      <mat-card>
        <h3>Insurance Details</h3>
        <mat-divider></mat-divider>
      
        <div class="grid">
          <mat-form-field appearance="fill">
            <mat-label>Insurance Provider</mat-label>
            <input matInput formControlName="insuranceprovider" />
          </mat-form-field>
      
          <mat-form-field appearance="fill">
            <mat-label>Policy Number</mat-label>
            <input matInput formControlName="insurancepolicyNumber" />
          </mat-form-field>
      
          <mat-form-field appearance="fill">
            <mat-label>Expiry Date</mat-label>
            <input matInput type="date" formControlName="insuranceexpiryDate" />
          </mat-form-field>
        </div>
      </mat-card>
      <div class="upload-section">
        <label mat-stroked-button color="primary" class="file-upload-label">
          <mat-icon>attach_file</mat-icon>
          Upload Medical Records
          <input
            type="file"
            (change)="onFileSelected($event)"
            hidden
          />
        </label>
        <span *ngIf="selectedFile">{{ selectedFile.name }}</span>
      </div>
      
      <div class="button-row">
        <button mat-raised-button class="submit" type="submit" [disabled]="loading">
          <mat-progress-spinner *ngIf="loading" diameter="20" mode="indeterminate"></mat-progress-spinner>
          {{ loading ? 'Saving...' : 'Save Patient' }}
        </button>
      </div>
      </form>
      </div>
                